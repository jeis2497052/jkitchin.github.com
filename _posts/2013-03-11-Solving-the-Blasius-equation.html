---
title: Solving the Blasius equation
date: 2013/03/11 10:44:56
updated: 2017/11/27 19:32:52
categories: BVP
tags: 
---


<p>
In fluid mechanics the Blasius equation comes up (<a href="http://en.wikipedia.org/wiki/Blasius_boundary_layer">http://en.wikipedia.org/wiki/Blasius_boundary_layer</a>) to describe the boundary layer that forms near a flat plate with fluid moving by it. The nonlinear differential equation is:
</p>

\begin{eqnarray}
f''' + \frac{1}{2} f f'' &=& 0 \\
f(0) &=& 0 \\
f'(0) &=& 0 \\
f'(\infty) &=& 1
\end{eqnarray}

<p>
This is a nonlinear, boundary value problem. The point of solving this equation is to get the value of \(f''(0)\) to evaluate the shear stress at the plate.
</p>

<p>
We have to convert this to a system of first-order differential equations. Let \(f_1 = f\), \(f_2 = f_1'\) and \(f_3 = f_2'\). This leads to:
</p>

\begin{eqnarray}
f_1' = f_2 \\
f_2' = f_3 \\
f_3' = -\frac{1}{2} f_1 f_3 \\
f_1(0) = 0 \\
f_2(0) = 0 \\
f_2(\infty) = 1
\end{eqnarray}

<p>
It is not possible to specify a boundary condition at \(\infty\) numerically, so we will have to use a large number, and verify it is "large enough". From the solution, we evaluate the derivatives at \(\eta=0\), and we have \(f''(0) = f_3(0)\).
</p>

<p>
We have to provide initial guesses for f_1, f_2 and f_3. This is the hardest part about this problem. We know that f_1 starts at zero, and is flat there (f'(0)=0), but at large eta, it has a constant slope of one. We will guess a simple line of slope = 1 for f_1. That is correct at large eta, and is zero at &eta;=0. If the slope of the function is constant at large \(\eta\), then the values of higher derivatives must tend to zero. We choose an exponential decay as a guess.
</p>

<p>
Finally, we let a solver iteratively find a solution for us, and find the answer we want. The solver is in the pycse module.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np
<span style="color: #0000FF;">from</span> pycse <span style="color: #0000FF;">import</span> bvp

<span style="color: #0000FF;">def</span> <span style="color: #006699;">odefun</span>(F, x):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">f1</span>, <span style="color: #BA36A5;">f2</span>, <span style="color: #BA36A5;">f3</span> = F.T
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> np.column_stack([f2,
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   f3,
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   -0.5 * f1 * f3])

<span style="color: #0000FF;">def</span> <span style="color: #006699;">bcfun</span>(Y):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">fa</span>, <span style="color: #BA36A5;">fb</span> = Y[0, :], Y[-1, :]
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> [fa[0],        <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">f1(0) =  0</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   fa[1],        <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">f2(0) = 0</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   1.0 - fb[1]]  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">f2(inf) = 1</span>

<span style="color: #BA36A5;">eta</span> = np.linspace(0, 6, 100)
<span style="color: #BA36A5;">f1init</span> = eta
<span style="color: #BA36A5;">f2init</span> = np.exp(-eta)
<span style="color: #BA36A5;">f3init</span> = np.exp(-eta)

<span style="color: #BA36A5;">Finit</span> = np.column_stack([f1init, f2init, f3init])

<span style="color: #BA36A5;">sol</span> = bvp(odefun, bcfun, eta, Finit)
<span style="color: #BA36A5;">f1</span>, <span style="color: #BA36A5;">f2</span>, <span style="color: #BA36A5;">f3</span> = sol.T

<span style="color: #0000FF;">print</span>(<span style="color: #008000;">"f''(0) = f_3(0) = {0}"</span>.<span style="color: #006FE0;">format</span>(f3[0]))

<span style="color: #0000FF;">import</span> matplotlib.pyplot <span style="color: #0000FF;">as</span> plt
plt.plot(eta, f1)
plt.xlabel(<span style="color: #008000;">'$\eta$'</span>)
plt.ylabel(<span style="color: #008000;">'$f(\eta)$'</span>)
plt.savefig(<span style="color: #008000;">'images/blasius.png'</span>)
</pre>
</div>

<pre class="example">
f''(0) = f_3(0) = 0.3324911095517483

</pre>


<p>
<img src="/media/blasius.png"> 
</p>

<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2017-05-17 Wed&gt; </span></span> You need pycse 1.6.4 for this example.
</p>
<p>Copyright (C) 2017 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p>
<p><a href="/org/2013/03/11/Solving-the-Blasius-equation.org">org-mode source</a></p>
<p>Org-mode version = 9.1.2</p>