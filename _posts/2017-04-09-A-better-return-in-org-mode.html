---
title: A better return in org-mode
date: 2017/04/09 10:56:42
updated: 2017/04/09 18:56:32
categories: emacs,orgmode
tags: 
---


<p>
Over on <a href="http://emacs.stackexchange.com/questions/24574/org-mode-default-to-alt-enter-for-bullets">Stackoverflow</a> someone wanted a better return in org-mode. They wanted return to add items in a list (instead of M-Ret).	Someone posted a partial solution, and here I improve on it to add new items to lists, new headings after a heading, and new rows to tables. In each case, a double return on an empty item, headline or table row will delete that line, and terminate the list, headlines or table. You can still use M-Ret, and this function falls through to org-return like it did before.
</p>

<p>
Here is the function. Give it a try. It is a small but helpful addition I think. I have not used it for long, so if you come across issues leave a comment!
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">scimax/org-return</span> ()
  <span style="color: #036A07;">"Add new list or headline "</span>
  (<span style="color: #0000FF;">interactive</span>)
  (<span style="color: #0000FF;">cond</span>
   ((org-in-item-p)
    (<span style="color: #0000FF;">if</span> (org-element-property <span style="color: #006FE0;">:contents-begin</span> (org-element-context))
        (org-insert-heading)
      (beginning-of-line)
      (<span style="color: #0000FF;">setf</span> (buffer-substring
             (line-beginning-position) (line-end-position)) <span style="color: #008000;">""</span>)
      (org-return)))
   ((org-at-heading-p)
    (<span style="color: #0000FF;">if</span> (not (string= <span style="color: #008000;">""</span> (org-element-property <span style="color: #006FE0;">:title</span> (org-element-context))))
        (<span style="color: #0000FF;">progn</span> (org-end-of-meta-data)
               (org-insert-heading))
      (beginning-of-line)
      (<span style="color: #0000FF;">setf</span> (buffer-substring
             (line-beginning-position) (line-end-position)) <span style="color: #008000;">""</span>)))
   ((org-at-table-p)
    (<span style="color: #0000FF;">if</span> (-any?
         (<span style="color: #0000FF;">lambda</span> (x) (not (string= <span style="color: #008000;">""</span> x)))
         (nth
          (- (org-table-current-dline) 1)
          (org-table-to-lisp)))
        (org-return)
      <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">empty row</span>
      (beginning-of-line)
      (<span style="color: #0000FF;">setf</span> (buffer-substring
             (line-beginning-position) (line-end-position)) <span style="color: #008000;">""</span>)
      (org-return)))
   (t
    (org-return))))

(define-key org-mode-map (kbd <span style="color: #008000;">"RET"</span>)
  'scimax/org-return)
</pre>
</div>
<p>Copyright (C) 2017 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p>
<p><a href="/org/2017/04/09/A-better-return-in-org-mode.org">org-mode source</a></p>
<p>Org-mode version = 9.0.5</p>